(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3919:(e,t,s)=>{Promise.resolve().then(s.bind(s,7939))},7939:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var n=s(5155),r=s(2115);let a=e=>{let{onTimeSelect:t,selectedTimes:s,onConfirm:a,isSelectingImpossible:l}=e,i=["월","화","수","목","금","토","일"],o=(e,t)=>s.some(s=>s.day===e&&s.hour===t),c=(e,t)=>{let s=u(e,t),n=o(e,t);if(l){if(s)return"bg-green-400";if(n)return"bg-red-500 hover:bg-red-600"}else if(n)return"bg-green-500 hover:bg-green-600";return"bg-gray-100 hover:bg-blue-100"},u=(e,t)=>JSON.parse(localStorage.getItem("possibleTimes")||"[]").some(s=>s.day===e&&s.hour===t),d=(e,s)=>{l&&u(e,s)||t(e,s)};return(0,n.jsxs)("div",{className:"w-full overflow-x-auto",children:[(0,n.jsx)("div",{className:"text-sm font-medium mb-2"}),(0,n.jsxs)("div",{className:"grid grid-cols-8 gap-1",children:[(0,n.jsx)("div",{className:"h-8"}),i.map(e=>(0,n.jsx)("div",{className:"h-8 flex items-center justify-center font-medium",children:e},e)),[8,9,10,11,12,13,14,15,16,17,18,19,20,21,22].map(e=>(0,n.jsxs)(r.Fragment,{children:[(0,n.jsx)("div",{className:"h-8 flex items-center justify-center text-sm",children:"".concat(e,":00")}),i.map(t=>(0,n.jsx)("button",{onClick:()=>d(t,e),disabled:l&&u(t,e),className:"h-8 transition-colors rounded-sm ".concat(c(t,e)," ").concat(l&&u(t,e)?"opacity-50 cursor-not-allowed":"")},"".concat(t,"-").concat(e)))]},e))]}),(0,n.jsx)("div",{className:"mt-4 flex justify-end",children:s.length>0?(0,n.jsx)("button",{onClick:()=>{l||localStorage.setItem("possibleTimes",JSON.stringify(s)),a()},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"선택 완료"}):(0,n.jsx)("div",{className:"px-4 py-2 h-[40px] w-[89px]"})})]})},l=e=>{let{onNameConfirm:t,onScheduleConfirm:s}=e,[l,i]=(0,r.useState)([]),[o,c]=(0,r.useState)(""),[u,d]=(0,r.useState)(""),[m,x]=(0,r.useState)(!1),[h,g]=(0,r.useState)([]),[f,b]=(0,r.useState)(!1),[p,y]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),[N,w]=(0,r.useState)(!0),[S,C]=(0,r.useState)(1),T=r.useRef(null),[k,E]=(0,r.useState)(0),I=r.useRef(null),[_,B]=(0,r.useState)(!1),[O,F]=(0,r.useState)(null),P=()=>{var e;null===(e=T.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};r.useEffect(()=>{P()},[l,f]),r.useEffect(()=>{q({text:"안녕하세요! 당신의 이름을 알려주세요.",sender:"bot"})},[]),r.useEffect(()=>{f&&I.current&&E(I.current.offsetHeight)},[f]);let q=async e=>{y(!0);let t={...e,text:"",isTyping:!0};i(e=>[...e,t]);let s=e.text,n="";for(let e=0;e<s.length;e++)await new Promise(e=>setTimeout(e,30)),n+=s[e],i(e=>e.map((t,s)=>s===e.length-1?{...t,text:n}:t));i(t=>t.map((s,n)=>n===t.length-1?{...e,isTyping:!1}:s)),y(!1)},A=async e=>{let n={text:e?"네":"아니오",sender:"user"};(i(e=>e.map(e=>({...e,showConfirmButtons:!1}))),i(e=>[...e,n]),m)?e?j?(await q({text:"선택하신 시간이 저장되었습니다.",sender:"bot"}),await q({text:"응답해 주셔서 감사합니다!",sender:"bot"}),s(h.map(e=>({...e,isImpossible:!0})),!0)):(await q({text:"선택하신 시간이 저장되었습니다.",sender:"bot"}),await q({text:"이제 참여가 불가능한 시간을 선택해주세요 (복수 선택 가능)",sender:"bot"}),s(h.map(e=>({...e,isImpossible:!1})),!1),g([]),v(!0),b(!0)):(await q({text:"다시 선택해주세요.",sender:"bot"}),b(!0)):e?(x(!0),C(0),setTimeout(()=>w(!1),1e3),await q({text:"환영합니다, ".concat(u,"님! 이제 준토에 참여하고 싶은 시간을 선택해주세요.(복수 선택 가능)"),sender:"bot"}),b(!0),t(u)):(d(""),await q({text:"죄송합니다. 다시 한 번 이름을 알려주시겠어요?",sender:"bot"}))},J=async()=>{if(!o.trim()||p)return;let e={text:o,sender:"user"};i(t=>[...t,e]),m||""!==u||(d(o),await q({text:"".concat(o,"님이 맞으신가요?"),sender:"bot",showConfirmButtons:!0})),c("")},R=async()=>{B(!0),F(k),b(!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{F(0)})});let e=h.reduce((e,t)=>(e[t.day]||(e[t.day]=[]),e[t.day].push(t.hour),e),{}),t=["월","화","수","목","금","토","일"].filter(t=>e[t]).map(t=>{let s=e[t].sort((e,t)=>e-t);return"".concat(t,"요일 : ").concat(s.map(e=>"".concat(e,"시")).join(", "))}).join("\n"),s={text:"선택하신 ".concat(j?"불가능한":"참여 희망"," 시간이\n").concat(t,"\n맞으신가요?"),sender:"bot",showConfirmButtons:!0};await q(s),setTimeout(()=>{B(!1)},1e3)};return(0,n.jsxs)("div",{className:"w-[800px] h-[calc(100vh-120px)] border border-gray-200 rounded-lg flex flex-col bg-white",children:[(0,n.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-50",children:[l.map((e,t)=>(0,n.jsx)("div",{className:"user"===e.sender?"flex flex-col items-end":"",children:(0,n.jsxs)("div",{className:"inline-block rounded-lg p-2 mb-2 shadow-sm whitespace-pre-line ".concat("user"===e.sender?"bg-blue-500 text-white":"bg-white"),children:[e.text,e.isTyping&&"▋"]})},t)),f?(0,n.jsx)("div",{ref:I,className:"my-4 animate-fade-in",children:(0,n.jsx)(a,{onTimeSelect:(e,t)=>{g(s=>{let n=s.findIndex(s=>s.day===e&&s.hour===t);return n>=0?s.filter((e,t)=>t!==n):[...s,{day:e,hour:t,isSelected:!0}]})},selectedTimes:h,onConfirm:R,isSelectingImpossible:j})}):_&&k>0?(0,n.jsx)("div",{className:"my-4 transition-all duration-1000 ease-in-out",style:{height:"".concat(O,"px"),opacity:0===O?0:1,marginTop:0===O?"0rem":"1rem",marginBottom:0===O?"0rem":"1rem"}}):null,(0,n.jsx)("div",{ref:T})]}),(0,n.jsxs)("div",{className:"relative",children:[l.some(e=>e.showConfirmButtons&&!e.isTyping)&&(0,n.jsxs)("div",{className:"absolute bottom-full right-4 mb-4 flex gap-2",children:[(0,n.jsx)("button",{onClick:()=>A(!0),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"네"}),(0,n.jsx)("button",{onClick:()=>A(!1),className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"아니오"})]}),N&&(0,n.jsxs)("div",{className:"flex p-4 border-t border-gray-200 bg-white transition-all duration-1000 ease-in-out",style:{opacity:S},children:[(0,n.jsx)("input",{type:"text",value:o,onChange:e=>c(e.target.value),onKeyPress:e=>"Enter"===e.key&&J(),placeholder:"메시지를 입력하세요...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg mr-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,n.jsx)("button",{onClick:J,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",children:"전송"})]})]})]})},i=e=>{let{userName:t,possibleTimes:s,impossibleTimes:r}=e,a=e=>{if(!e||0===e.length)return null;let t=e.reduce((e,t)=>(e[t.day]||(e[t.day]=[]),e[t.day].push(t.hour),e),{});return["월","화","수","목","금","토","일"].filter(e=>t[e]).map(e=>{let s=t[e].sort((e,t)=>e-t);return"".concat(e,"요일 ").concat(s.map(e=>"".concat(e,"시")).join(", "))}).join(" | ")};return(0,n.jsx)("footer",{className:"bg-gray-100 h-[120px] flex items-center",children:(0,n.jsx)("div",{className:"container mx-auto text-center h-full flex items-center",children:t?(0,n.jsxs)("div",{className:"w-full space-y-2",children:[(0,n.jsxs)("p",{className:"text-gray-600 h-[24px]",children:[t,"님 환영합니다!"]}),s&&s.length>0&&(0,n.jsxs)("p",{className:"text-sm text-green-600 h-[24px]",children:["참여 가능 시간: ",a(s)]}),r&&r.length>0&&(0,n.jsxs)("p",{className:"text-sm text-red-600 h-[24px]",children:["참여 불가능 시간: ",a(r)]})]}):(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)("p",{className:"text-gray-600",children:"채팅창에서 이름을 입력해주세요."})})})})};function o(){let[e,t]=(0,r.useState)(""),[s,a]=(0,r.useState)([]),[o,c]=(0,r.useState)([]);return(0,n.jsxs)("main",{className:"min-h-screen flex flex-col",children:[(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,n.jsx)(l,{onNameConfirm:e=>{t(e)},onScheduleConfirm:(e,t)=>{t?c(e):a(e)}})}),(0,n.jsx)(i,{userName:e,possibleTimes:s,impossibleTimes:o})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(3919)),_N_E=e.O()}]);